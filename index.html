
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ëñ™Ë≥áËá™ÂãïË®àÁÆóÁ≥ªÁµ± - Â∞àÊ•≠ÂêåÊ≠•Áâà</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #f8fafc;
        }
        select {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%2364748b'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 0.5rem center;
            background-size: 1.25rem;
            padding-right: 2rem;
            color: #1e293b !important;
        }
        input[type="time"]::-webkit-calendar-picker-indicator {
            cursor: pointer;
            opacity: 0.6;
            transition: opacity 0.2s;
        }
        
        .sync-active { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: .5; } }

        @media print {
            @page { size: A4; margin: 1cm; }
            body { background-color: white; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            .no-print { display: none !important; }
            input[type="time"]::-webkit-calendar-picker-indicator { display: none; }
            input[type="time"] { border: none; background: transparent; padding: 0; }
        }
    </style>
    <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@19.0.0",
        "react-dom/client": "https://esm.sh/react-dom@19.0.0/client"
      }
    }
    </script>
</head>
<body>
    <div id="root"></div>

    <script type="module">
        import React, { useState, useEffect, useCallback, useMemo } from 'react';
        import { createRoot } from 'react-dom/client';

        // --- Configuration ---
        const DEFAULT_SHEET_ID = "172dQb2Dh7KLFbsYzehQR2xr_7AVtsb3gonSCZZCkIYQ";

        // --- Utils ---
        const timeToMinutes = (timeStr) => {
            if (!timeStr) return 0;
            const parts = timeStr.split(':').map(Number);
            return (parts[0] || 0) * 60 + (parts[1] || 0);
        };

        const calculateDuration = (start, end) => {
            const startMins = timeToMinutes(start);
            const endMins = timeToMinutes(end);
            return endMins > startMins ? (endMins - startMins) / 60 : 0;
        };

        const getDefaultTimes = (dayOfWeek) => {
            if (dayOfWeek === 2) return { start: '16:00', end: '18:00', skipped: false };
            if (dayOfWeek === 0 || dayOfWeek === 6) return { start: '', end: '', skipped: true };
            return { start: '11:30', end: '18:30', skipped: false };
        };

        const formatDateKey = (year, month, day) => `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
        
        const getDaysInMonth = (year, month) => {
            const y = parseInt(year, 10);
            const m = parseInt(month, 10);
            if (isNaN(y) || isNaN(m)) return 31;
            return new Date(y, m + 1, 0).getDate();
        };

        const getFirstDayOfMonth = (year, month) => {
            const y = parseInt(year, 10);
            const m = parseInt(month, 10);
            if (isNaN(y) || isNaN(m)) return 0;
            return new Date(y, m, 1).getDay();
        };

        const cleanToShortTime = (val) => {
            if (!val) return '';
            const str = val.toString().trim();
            const timePart = str.includes(' ') ? str.split(/\s+/)[1] : str;
            const match = timePart.match(/(\d{1,2}):(\d{1,2})/);
            if (match) {
                return `${match[1].padStart(2, '0')}:${match[2].padStart(2, '0')}`;
            }
            return '';
        };

        // Ê†∏ÂøÉÊõ¥Êñ∞ÔºöÊé°Áî® Component Parsing ÊâãÂãïÊãÜËß£Âπ¥ÊúàÊó•ÔºåÈÅøÂÖçÊôÇÂçÄÂÅèÁßª
        const cleanToDateKey = (val) => {
            if (!val) return null;
            const str = val.toString().trim();
            // ÊäìÂèñ YYYY, MM, DD Êï∏ÂÄºÔºåÁõ∏ÂÆπ / Êàñ - ÂàÜÈöîÁ¨¶
            const match = str.match(/(\d{4})[\/\-](\d{1,2})[\/\-](\d{1,2})/);
            if (match) {
                const y = parseInt(match[1], 10);
                const m = parseInt(match[2], 10) - 1; // JS Date month is 0-indexed
                const d = parseInt(match[3], 10);
                return formatDateKey(y, m, d);
            }
            // ÂÇôÁî®ÊñπÊ°à
            const fallbackDate = new Date(str);
            if (!isNaN(fallbackDate.getTime())) {
                return formatDateKey(fallbackDate.getFullYear(), fallbackDate.getMonth(), fallbackDate.getDate());
            }
            return null;
        };

        // Á©©ÂÅ•ÁöÑ CSV Ëß£ÊûêÂô®
        const parseCSV = (text) => {
            if (!text) return { headers: [], data: [] };
            const lines = text.split(/\r?\n/).filter(line => line.trim() !== "");
            if (lines.length === 0) return { headers: [], data: [] };

            const splitLine = (line) => {
                const result = [];
                let current = '';
                let inQuotes = false;
                for (let i = 0; i < line.length; i++) {
                    const char = line[i];
                    if (char === '"') {
                        if (inQuotes && line[i+1] === '"') {
                            current += '"';
                            i++;
                        } else {
                            inQuotes = !inQuotes;
                        }
                    } else if (char === ',' && !inQuotes) {
                        result.push(current.trim());
                        current = '';
                    } else {
                        current += char;
                    }
                }
                result.push(current.trim());
                return result;
            };

            const rawHeaders = splitLine(lines[0]);
            // Ê∏ÖÁêÜÊ®ôÈ°åÂàó‰∏≠ÁöÑ‰∏çÂèØË¶ãÂ≠óÂÖÉ (BOM or spaces)
            const headers = rawHeaders.map(h => h.replace(/[^\x20-\x7E\u4e00-\u9fa5]/g, '').trim());

            const data = lines.slice(1).map(line => {
                const values = splitLine(line);
                return headers.reduce((obj, header, i) => {
                    obj[header] = values[i] || "";
                    return obj;
                }, {});
            });

            return { headers, data };
        };

        // --- Components ---
        const DayCell = ({ day, dateKey, dayOfWeek, entry, onUpdate, isWeekend }) => {
            const dayNames = ['Êó•', '‰∏Ä', '‰∫å', '‰∏â', 'Âõõ', '‰∫î', 'ÂÖ≠'];
            const duration = calculateDuration(entry.start, entry.end);

            return React.createElement('div', {
                className: `min-h-[110px] p-2 border-r border-b transition-colors ${entry.skipped ? 'bg-gray-100/60' : isWeekend ? 'bg-indigo-50/40' : 'bg-white'} hover:bg-slate-50 relative group`
            }, [
                React.createElement('div', { key: 'header', className: "flex justify-between items-start mb-2" }, [
                    React.createElement('div', { key: 'label', className: "flex items-baseline gap-1" }, [
                        React.createElement('span', { key: 'd', className: `text-lg font-bold ${isWeekend ? 'text-red-500' : 'text-indigo-700'}` }, day),
                        React.createElement('span', { key: 'w', className: "text-xs text-gray-500 font-medium" }, `ÈÄ±${dayNames[dayOfWeek]}`)
                    ]),
                    React.createElement('div', { key: 'skip', className: "flex items-center gap-1 no-print" }, [
                        React.createElement('input', {
                            type: "checkbox",
                            id: `skip-${dateKey}`,
                            checked: entry.skipped,
                            onChange: (e) => onUpdate(dateKey, { skipped: e.target.checked }),
                            className: "w-4 h-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500 cursor-pointer"
                        }),
                        React.createElement('label', { htmlFor: `skip-${dateKey}`, className: "text-[10px] text-gray-400 cursor-pointer" }, "‰ºëÂÅá")
                    ]),
                    !entry.skipped && React.createElement('div', { key: 'print-h', className: "hidden print:block text-xs font-bold text-gray-700" }, `${duration.toFixed(1)}h`)
                ]),
                entry.skipped 
                    ? React.createElement('div', { key: 'vacation', className: "flex items-center justify-center h-12" }, 
                        React.createElement('span', { className: "text-lg font-bold text-gray-400 tracking-widest" }, "‰ºëÂÅá")
                      )
                    : React.createElement('div', { key: 'inputs', className: "space-y-1" }, [
                        ['‰∏äÁè≠', 'start'], ['‰∏ãÁè≠', 'end']
                    ].map(([label, key]) => (
                        React.createElement('div', { key, className: "flex items-center gap-1" }, [
                            React.createElement('label', { key: 'l', className: "text-[10px] text-gray-400 w-7 no-print" }, label),
                            React.createElement('input', {
                                key: 'i',
                                type: "time",
                                value: entry[key],
                                onChange: (e) => onUpdate(dateKey, { [key]: e.target.value }),
                                className: "w-full text-xs p-1 pr-6 border border-transparent group-hover:border-gray-200 rounded focus:outline-none focus:ring-1 focus:ring-indigo-300 print:border-none"
                            })
                        ])
                    )))
            ]);
        };

        const SyncModal = ({ isOpen, onClose, onSync, initialConfig }) => {
            if (!isOpen) return null;
            const [sheetId, setSheetId] = useState(initialConfig?.sheetId || DEFAULT_SHEET_ID);
            const [isLoading, setIsLoading] = useState(false);
            const [error, setError] = useState('');
            const [step, setStep] = useState(1);
            const [tempData, setTempData] = useState(null);
            const [mapping, setMapping] = useState(initialConfig?.mapping || { date: '', start: '', end: '' });

            const handleFetch = async () => {
                setIsLoading(true);
                setError('');
                try {
                    const csvUrl = `https://docs.google.com/spreadsheets/d/${sheetId}/export?format=csv`;
                    const response = await fetch(csvUrl);
                    if (!response.ok) throw new Error('ËÆÄÂèñÂ§±Êïó„ÄÇË´ãÁ¢∫Ë™çË©¶ÁÆóË°®ÂÖ±Áî®Ë®≠ÂÆö„ÄÇ');
                    const text = await response.text();
                    const parsed = parseCSV(text);
                    if (parsed.headers.length === 0) throw new Error('Ë©¶ÁÆóË°®ÂÖßÂÆπÁÇ∫Á©∫„ÄÇ');
                    
                    setTempData(parsed);
                    
                    // Ëá™ÂãïÂåπÈÖç
                    setMapping({
                        date: mapping.date || parsed.headers.find(h => h.includes('Êó•Êúü')) || '',
                        start: mapping.start || parsed.headers.find(h => h.includes('‰∏äÁè≠ÊôÇÈñì')) || '',
                        end: mapping.end || parsed.headers.find(h => h.includes('‰∏ãÁè≠ÊôÇÈñì')) || ''
                    });
                    setStep(2);
                } catch (err) {
                    setError(err.message);
                } finally {
                    setIsLoading(false);
                }
            };

            const executeSync = () => {
                if (!mapping.date || !mapping.start || !mapping.end) {
                    alert('Ë´ãÈÅ∏ÊìáÊ≠£Á¢∫ÁöÑÂ∞çÊáâÊ¨Ñ‰ΩçÔºÅ');
                    return;
                }
                onSync({ sheetId, mapping }, tempData.data);
                onClose();
            };

            return React.createElement('div', { className: "fixed inset-0 z-[60] flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm" }, [
                React.createElement('div', { key: 'm', className: "bg-white w-full max-w-md rounded-2xl shadow-2xl overflow-hidden" }, [
                    React.createElement('div', { className: "p-6 border-b flex justify-between items-center" }, [
                        React.createElement('h3', { className: "text-lg font-bold text-slate-800" }, "Google Sheets ÂêåÊ≠•Ë®≠ÂÆö"),
                        React.createElement('button', { onClick: onClose, className: "text-slate-400 hover:text-slate-600" }, "‚úï")
                    ]),
                    React.createElement('div', { className: "p-6" }, 
                        step === 1 ? React.createElement('div', { className: "space-y-4" }, [
                            React.createElement('p', { key: 'p', className: "text-sm text-slate-500" }, "Ë´ãËº∏ÂÖ•Ë©¶ÁÆóË°® IDÔºö"),
                            React.createElement('input', {
                                key: 'in',
                                type: "text",
                                value: sheetId,
                                onChange: e => setSheetId(e.target.value),
                                className: "w-full border p-3 rounded-xl text-sm focus:ring-2 focus:ring-indigo-500 outline-none"
                            }),
                            error && React.createElement('p', { key: 'e', className: "text-xs text-red-500" }, error)
                        ]) : React.createElement('div', { className: "space-y-3" }, [
                            React.createElement('p', { key: 'p', className: "text-sm text-slate-500 mb-2" }, "ÊäìÂèñÊàêÂäüÔºÅË´ãÁ¢∫Ë™çÊ¨Ñ‰ΩçÂ∞çÊáâÔºö"),
                            ['Êó•ÊúüÊ¨Ñ‰Ωç', 'date'], ['‰∏äÁè≠ÊôÇÈñì', 'start'], ['‰∏ãÁè≠ÊôÇÈñì', 'end']
                        ].map(m => Array.isArray(m) ? React.createElement('div', { key: m[1] }, [
                            React.createElement('label', { className: "text-[10px] font-bold text-slate-400 block mb-1" }, m[0]),
                            React.createElement('select', {
                                value: mapping[m[1]],
                                onChange: e => setMapping(p => ({ ...p, [m[1]]: e.target.value })),
                                className: "w-full border p-2 rounded-lg text-sm bg-slate-50"
                            }, [
                                React.createElement('option', { value: "" }, "-- ÈÅ∏ÊìáÊ¨Ñ‰Ωç --"),
                                ...tempData.headers.map(h => React.createElement('option', { key: h, value: h }, h))
                            ])
                        ]) : m))
                    ),
                    React.createElement('div', { className: "p-6 bg-slate-50 flex gap-2" }, [
                        step === 1 
                        ? React.createElement('button', { onClick: handleFetch, className: "w-full bg-indigo-600 text-white py-3 rounded-xl font-bold hover:bg-indigo-700" }, isLoading ? "ÈÄ£Á∑ö‰∏≠..." : "‰∏ã‰∏ÄÊ≠•")
                        : [
                            React.createElement('button', { key: 'b', onClick: () => setStep(1), className: "flex-1 bg-white border py-3 rounded-xl font-bold hover:bg-slate-100" }, "ËøîÂõû"),
                            React.createElement('button', { key: 's', onClick: executeSync, className: "flex-1 bg-emerald-600 text-white py-3 rounded-xl font-bold hover:bg-emerald-700" }, "ÂÑ≤Â≠òÂêåÊ≠•")
                        ]
                    ])
                ])
            ]);
        };

        const App = () => {
            const currentYear = new Date().getFullYear();
            const [year, setYear] = useState(currentYear);
            const [month, setMonth] = useState(new Date().getMonth());
            const [hourlyRate, setHourlyRate] = useState(196);
            const [calendarData, setCalendarData] = useState({});
            const [syncConfig, setSyncConfig] = useState({ sheetId: DEFAULT_SHEET_ID, mapping: null });
            const [isSyncing, setIsSyncing] = useState(false);
            const [isSyncModalOpen, setIsSyncModalOpen] = useState(false);

            useEffect(() => {
                const saved = localStorage.getItem('salary-v12-final');
                if (saved) {
                    const parsed = JSON.parse(saved);
                    setCalendarData(parsed.data || {});
                    setHourlyRate(parsed.rate || 196);
                    if (parsed.sync) setSyncConfig(parsed.sync);
                }
            }, []);

            useEffect(() => {
                localStorage.setItem('salary-v12-final', JSON.stringify({ data: calendarData, rate: hourlyRate, sync: syncConfig }));
            }, [calendarData, hourlyRate, syncConfig]);

            const handleUpdateEntry = useCallback((dateKey, updates) => {
                setCalendarData(prev => {
                    const existing = prev[dateKey] || { dateKey, ...getDefaultTimes(new Date(dateKey).getDay()), duration: 0 };
                    const updated = { ...existing, ...updates };
                    updated.duration = calculateDuration(updated.start, updated.end);
                    return { ...prev, [dateKey]: updated };
                });
            }, []);

            const processSync = (config, rows) => {
                const newEntries = { ...calendarData };
                const dayGroups = {};
                
                rows.forEach(row => {
                    const dateKey = cleanToDateKey(row[config.mapping.date]);
                    if (!dateKey) return;
                    const start = cleanToShortTime(row[config.mapping.start]);
                    const end = cleanToShortTime(row[config.mapping.end]);
                    if (start || end) dayGroups[dateKey] = { start, end };
                });

                let updatedCount = 0;
                let vacationCount = 0;
                const daysInMonth = getDaysInMonth(year, month);

                for (let d = 1; d <= daysInMonth; d++) {
                    const dateKey = formatDateKey(year, month, d);
                    const record = dayGroups[dateKey];
                    if (record && record.start && record.end) {
                        newEntries[dateKey] = {
                            dateKey, start: record.start, end: record.end,
                            skipped: false, duration: calculateDuration(record.start, record.end)
                        };
                        updatedCount++;
                    } else {
                        const dayOfWeek = new Date(year, month, d).getDay();
                        newEntries[dateKey] = {
                            ...getDefaultTimes(dayOfWeek), dateKey, skipped: true, duration: 0
                        };
                        vacationCount++;
                    }
                }
                setSyncConfig(config);
                setCalendarData(newEntries);
                alert(`ÂêåÊ≠•ÂÆåÊàêÔºÅ\nüìÖ ÁõÆÂâçÊúà‰ªΩÔºö${year}Âπ¥ ${month+1}Êúà\nüìä ÊàêÂäüÊØîÂ∞çÔºö${updatedCount} Á≠ÜË≥áÊñô\nüõå ÁÑ°Ë®òÈåÑÊ®ôË®ò‰ºëÂÅáÔºö${vacationCount} Â§©`);
            };

            const fastSync = async () => {
                if (!syncConfig || !syncConfig.mapping) {
                    setIsSyncModalOpen(true);
                    return;
                }
                setIsSyncing(true);
                try {
                    const csvUrl = `https://docs.google.com/spreadsheets/d/${syncConfig.sheetId}/export?format=csv`;
                    const response = await fetch(csvUrl);
                    if (!response.ok) throw new Error();
                    const text = await response.text();
                    const parsed = parseCSV(text);
                    processSync(syncConfig, parsed.data);
                } catch (e) {
                    alert('ÂêåÊ≠•Â§±ÊïóÔºåË´ãÁ¢∫Ë™çË©¶ÁÆóË°® ID ËàáÁ∂≤Ë∑ØÁãÄÊÖã„ÄÇ');
                } finally {
                    setIsSyncing(false);
                }
            };

            const totalHours = useMemo(() => {
                let total = 0;
                const daysInMonth = getDaysInMonth(year, month);
                for (let d = 1; d <= daysInMonth; d++) {
                    const key = formatDateKey(year, month, d);
                    const entry = calendarData[key] || { ...getDefaultTimes(new Date(year, month, d).getDay()) };
                    if (!entry.skipped) total += calculateDuration(entry.start, entry.end);
                }
                return total;
            }, [year, month, calendarData]);

            const daysGrid = useMemo(() => {
                const firstDay = getFirstDayOfMonth(year, month);
                const grid = Array.from({ length: Math.max(0, firstDay) }, () => null);
                const daysInMonth = getDaysInMonth(year, month);
                for (let d = 1; d <= daysInMonth; d++) {
                    const dateKey = formatDateKey(year, month, d);
                    const dayOfWeek = new Date(year, month, d).getDay();
                    grid.push({ 
                        day: d, dateKey, dayOfWeek, 
                        entry: calendarData[dateKey] || { dateKey, ...getDefaultTimes(dayOfWeek), duration: 0 } 
                    });
                }
                return grid;
            }, [year, month, calendarData]);

            return React.createElement('div', { className: "max-w-6xl mx-auto p-4 md:p-8 min-h-screen" }, [
                React.createElement('header', { key: 'h', className: "mb-8 flex flex-col md:flex-row justify-between items-start md:items-end gap-6" }, [
                    React.createElement('div', null, [
                        React.createElement('h1', { className: "text-3xl font-extrabold text-slate-800 flex items-center gap-3" }, [
                            "Ëñ™Ë≥áËá™ÂãïË®àÁÆóÁ≥ªÁµ±",
                            syncConfig.mapping && React.createElement('span', { className: "px-2 py-0.5 bg-emerald-100 text-emerald-600 text-[10px] rounded-full" }, "ÈÄ£ÂãïÊ≠£Â∏∏")
                        ]),
                        React.createElement('p', { className: "text-slate-500 no-print" }, "Á≤æÊ∫ñÂêåÊ≠•Ê®°ÂºèÔºöËá™ÂãïÊäìÂèñÊó•ÊúüËàáËµ∑Ë®ñÊôÇÈñì")
                    ]),
                    React.createElement('div', { className: "flex items-center gap-4 no-print" }, [
                        React.createElement('button', { 
                            onClick: fastSync,
                            disabled: isSyncing,
                            className: `p-2.5 bg-emerald-50 text-emerald-600 rounded-xl border border-emerald-100 hover:bg-emerald-100 transition-all ${isSyncing ? 'sync-active' : ''}`
                        }, React.createElement('span', { className: "text-lg" }, "üîÑ")),
                        React.createElement('div', { className: "flex gap-2 bg-white p-2.5 rounded-2xl shadow-sm border" }, [
                            { label: 'Âπ¥‰ªΩ', val: year, set: setYear, opt: Array.from({length:11}, (_,i)=>currentYear-5+i) },
                            { label: 'Êúà‰ªΩ', val: month, set: setMonth, opt: Array.from({length:12}, (_,i)=>i) }
                        ].map(s => React.createElement('div', { key: s.label, className: "flex flex-col" }, [
                            React.createElement('span', { className: "text-[9px] font-bold text-slate-400 mb-0.5 ml-1" }, s.label),
                            React.createElement('select', { 
                                value: s.val, 
                                onChange: e => s.set(Number(e.target.value)),
                                className: "bg-transparent px-3 py-1 text-sm font-bold min-w-[90px] text-slate-800 outline-none"
                            }, s.opt.map(o => React.createElement('option', { key: o, value: o }, s.label === 'Êúà‰ªΩ' ? `${o+1} Êúà` : `${o} Âπ¥`)))
                        ])))
                    ])
                ]),
                React.createElement('main', { key: 'm', className: "bg-white rounded-3xl shadow-sm border overflow-hidden" }, [
                    React.createElement('div', { className: "grid grid-cols-7 bg-slate-50 border-b" }, ['Êó•','‰∏Ä','‰∫å','‰∏â','Âõõ','‰∫î','ÂÖ≠'].map((d,i)=>React.createElement('div',{key:d, className:`py-3 text-center text-[10px] font-black uppercase tracking-wider ${i===0||i===6?'text-rose-400':'text-slate-400'}`},`ÈÄ±${d}`))),
                    React.createElement('div', { className: "grid grid-cols-7 border-l" }, daysGrid.map((item, i) => 
                        !item ? React.createElement('div', { key: `e-${i}`, className: "bg-slate-50 border-r border-b" }) :
                        React.createElement(DayCell, { key: item.dateKey, ...item, onUpdate: handleUpdateEntry, isWeekend: item.dayOfWeek === 0 || item.dayOfWeek === 6 })
                    ))
                ]),
                React.createElement('div', { key: 's', className: "mt-8 bg-white border border-slate-200 rounded-3xl shadow-xl p-8 print:border-2 print:border-black print:rounded-none" }, [
                    React.createElement('div', { className: "flex flex-col md:flex-row justify-between items-center mb-8 border-b pb-6 print:hidden" }, [
                        React.createElement('h2', { className: "text-2xl font-black text-slate-800" }, "Ëñ™Ë≥áÁµêÁÆóÂ†±Âëä"),
                        React.createElement('div', { className: "flex gap-3" }, [
                            React.createElement('button', { 
                                onClick: () => setIsSyncModalOpen(true), 
                                className: "px-6 py-2.5 bg-emerald-600 text-white border border-emerald-500 rounded-xl hover:bg-emerald-700 transition-all font-bold shadow-sm" 
                            }, "‚öô ÂêåÊ≠•Ë®≠ÂÆö"),
                            React.createElement('button', { onClick: () => window.print(), className: "px-6 py-2.5 bg-slate-900 text-white rounded-xl hover:bg-slate-800 transition-all font-bold shadow-lg shadow-slate-200" }, "ÂàóÂç∞Â†±Ë°®")
                        ])
                    ]),
                    React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-3 gap-8 mb-10 print:grid-cols-3 print:gap-4" }, [
                        { label: 'ÊôÇËñ™ (TWD)', val: React.createElement('input', { type: 'number', value: hourlyRate, onChange: e => setHourlyRate(Number(e.target.value)), className: "w-full bg-transparent text-3xl font-black text-indigo-600 focus:outline-none print:text-black" }) },
                        { label: 'Á∏ΩË®àÂ∑•ÊôÇ', val: `${totalHours.toFixed(2)}`, suffix: 'Hrs', color: 'text-emerald-500' },
                        { label: 'È†êË®àÁ∏ΩËñ™Ë≥á', val: `${(totalHours * hourlyRate).toLocaleString()}`, suffix: 'TWD', color: 'text-rose-500' }
                    ].map((s, i) => (
                        React.createElement('div', { key: i, className: "p-6 bg-slate-50 rounded-2xl border border-slate-100 print:bg-white print:border-black" }, [
                            React.createElement('label', { className: "block text-[10px] font-black text-slate-400 uppercase tracking-widest mb-2" }, s.label),
                            React.createElement('div', { className: "flex items-baseline gap-2" }, [
                                typeof s.val === 'string' ? React.createElement('span', { className: `text-3xl font-black ${s.color} print:text-black` }, s.val) : s.val,
                                s.suffix && React.createElement('span', { className: "text-xs font-bold text-slate-400" }, s.suffix)
                            ])
                        ])
                    ))),
                    React.createElement('div', { className: "mt-12 pt-10 border-t border-dashed grid grid-cols-3 gap-16 print:mt-4 print:pt-4" }, ['Á¢∫Ë™çÁ∞ΩÂêç', '‰∏ªÁÆ°Ë¶ÜÊ†∏', 'Ë≤°Âãô‰∫∫Âì°'].map(t => (
                        React.createElement('div', { key: t, className: "flex flex-col gap-6" }, [
                            React.createElement('span', { className: "text-xs font-bold text-slate-400 uppercase tracking-widest print:text-black" }, t),
                            React.createElement('div', { className: "border-b-2 border-slate-200 h-10 print:border-black" })
                        ])
                    )))
                ]),
                React.createElement(SyncModal, { key: 'sync', isOpen: isSyncModalOpen, onClose: () => setIsSyncModalOpen(false), onSync: processSync, initialConfig: syncConfig })
            ]);
        };

        const root = createRoot(document.getElementById('root'));
        root.render(React.createElement(App));
    </script>
</body>
</html>
